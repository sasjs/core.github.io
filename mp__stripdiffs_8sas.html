<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- HTML header for doxygen 1.8.17-->
<html xmlns="https://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta property="og:type" content="website">
  <meta property="og:title" content="MacroCore" />
  <meta property="og:url" content="https://core.sasjs.io" />
  <meta property="og:image" content="https://core.sasjs.io/Macro_core_website_1.png" />
  <meta name="author" content="Allan Bowe">
  <meta name="generator" content="Doxygen 1.10.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Macros for SAS Application Developers" />
  <meta name="og:description" content="Macros for SAS Application Developers" />
  <title>base/mp_stripdiffs.sas File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <link href="new_stylesheet.css" rel="stylesheet" type="text/css"/>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function () {
      var u = "https://analytics.4gl.io/";
      _paq.push(['setTrackerUrl', u + 'matomo.php']);
      _paq.push(['setSiteId', '6']);
      var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
      g.async = true; g.src = u + 'matomo.js'; s.parentNode.insertBefore(g, s);
    })();
  </script>
  <!-- End Matomo Code -->
</head>
<body>
  <div id="top">
    <!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0">
        <tbody>
          <tr style="height: 56px">
            <td id="projectlogo">
              <a href=""><img alt="Logo" src="Macro_core_website_1.png" /></a>
            </td>
            <td id="projectalign" style="padding-left: 0.5em">
              <div id="projectbrief">
                Macros for SAS Application Developers<br />
                <a href="https://github.com/sasjs/core">
                  https://github.com/sasjs/core
                </a>
              </div>
            </td>
          </tr>
      </table>
      </td>
      </tr>
      </tbody>
      </table>
    </div>
    <!-- end header part -->
  </div>
</body>
</html>
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('mp__stripdiffs_8sas.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mp_stripdiffs.sas File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Generates a stage dataset to revert diffs tracked in an audit table.  
<a href="#details">More...</a></p>

<p><a href="mp__stripdiffs_8sas_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A big benefit of tracking data changes in an audit table is that those changes can be subsequently reverted if necessary!</p>
<p>This macro prepares a staging dataset containing those differences - eg for:</p>
<ul>
<li>deleted rows - these are re-inserted </li>
<li>changed rows - differences are reverted </li>
<li>added rows - marked with <code>_____DELETE__THIS__RECORD_____="YES"</code></li>
</ul>
<p>These changes are NOT applied to the base table - a staging dataset is simply prepared for an ETL process to action. In Data Controller, this dataset is used directly as an input to the APPROVE process (so that the reversion diffs can be reviewed prior to being applied).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">libds</td><td>Base library.dataset (will not be modified). The library must be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">loadref</td><td>Unique identifier for the version to be reverted. This change, plus ALL SUBSEQUENT CHANGES, will be reverted in the output table. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">difftable</td><td>The dataset containing the diffs. Definition available in <a class="el" href="mddl__dc__difftable_8sas.html" title="Difftable DDL.">mddl_dc_difftable.sas</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filtervar=</td><td>(0) If provided, the contents of this macro variable will be applied as an additional filter against &amp;libds </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outds=</td><td>(work.mp_stripdiffs) Output table containing the diffs. Has the same format as the base datset, plus a <code>_____DELETE__THIS__RECORD_____</code> variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mdebug=</td><td>set to 1 to enable DEBUG messages and preserve outputs</td></tr>
  </table>
  </dd>
</dl>
<h4>SAS Macros </h4>
<ul>
<li><a class="el" href="mf__getuniquefileref_8sas.html" title="Assigns and returns an unused fileref.">mf_getuniquefileref.sas</a> </li>
<li><a class="el" href="mf__getuniquename_8sas.html" title="Returns a shortened (32 char) GUID as a valid SAS name.">mf_getuniquename.sas</a> </li>
<li><a class="el" href="mf__getvarlist_8sas.html" title="Returns dataset variable list direct from header.">mf_getvarlist.sas</a> </li>
<li><a class="el" href="mf__islibds_8sas.html" title="Checks whether a string follows correct library.dataset format.">mf_islibds.sas</a> </li>
<li><a class="el" href="mf__wordsinstr1butnotstr2_8sas.html" title="Returns words that are in string 1 but not in string 2.">mf_wordsinstr1butnotstr2.sas</a> </li>
<li><a class="el" href="mp__abort_8sas.html" title="abort gracefully according to context">mp_abort.sas</a></li>
</ul>
<h4>Related Macros </h4>
<ul>
<li><a class="el" href="mddl__dc__difftable_8sas.html" title="Difftable DDL.">mddl_dc_difftable.sas</a> </li>
<li><a class="el" href="mp__stackdiffs_8sas.html" title="Prepares an audit table for stacking (re-applying) the changes.">mp_stackdiffs.sas</a> </li>
<li><a class="el" href="mp__storediffs_8sas.html" title="Converts deletes/changes/appends into a single audit table.">mp_storediffs.sas</a> </li>
<li><a class="el" href="mp__stripdiffs_8test_8sas.html" title="Testing mp_stripdiffs.sas macro.">mp_stripdiffs.test.sas</a></li>
</ul>
<dl class="section version"><dt>Version</dt><dd>9.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Allan Bowe </dd></dl>

<p class="definition">Definition in file <a class="el" href="mp__stripdiffs_8sas_source.html">mp_stripdiffs.sas</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
  <!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e914ee4d4a44400f1fdb170cb4ead18a.html">base</a></li><li class="navelem"><a class="el" href="mp__stripdiffs_8sas.html">mp_stripdiffs.sas</a></li>
    <li class="footer">
      Generated by
      <a href="https://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.svg" alt="doxygen"
      /></a>
      1.10.0
    </li>
    <li>
      <i> For more information visit the </i>
      <a href="https://github.com/sasjs/core">Macro Core library</a>.
    </li>
  </ul>
</div>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- HTML header for doxygen 1.8.17-->
<html xmlns="https://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta property="og:type" content="website">
  <meta property="og:title" content="MacroCore" />
  <meta property="og:url" content="https://core.sasjs.io" />
  <meta property="og:image" content="https://core.sasjs.io/Macro_core_website_1.png" />
  <meta name="author" content="Allan Bowe">
  <meta name="generator" content="Doxygen 1.9.3" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Macros for SAS Application Developers" />
  <meta name="og:description" content="Macros for SAS Application Developers" />
  <title>base/mp_abort.sas File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <link href="new_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
  <div id="top">
    <!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0">
        <tbody>
          <tr style="height: 56px">
            <td id="projectlogo">
              <a href=""><img alt="Logo" src="Macro_core_website_1.png" /></a>
            </td>
            <td id="projectalign" style="padding-left: 0.5em">
              <div id="projectbrief">
                Macros for SAS Application Developers<br />
                <a href="https://github.com/sasjs/core">
                  https://github.com/sasjs/core
                </a>
              </div>
            </td>
          </tr>
      </table>
      </td>
      </tr>
      </tbody>
      </table>
    </div>
    <!-- end header part -->
  </div>
</body>
</html><!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mp__abort_8sas.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mp_abort.sas File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>abort gracefully according to context  
<a href="#details">More...</a></p>

<p><a href="mp__abort_8sas_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Configures an abort mechanism according to site specific policies or the particulars of an environment. For instance, can stream custom results back to the client in an STP Web App context, or completely stop in the case of a batch run. For STP sessions</p>
<p >The method used varies according to the context. Important points:</p>
<ul>
<li>should not use endsas or abort cancel in 9.4m3 environments as this can cause hung multibridge sessions and result in a frozen STP server </li>
<li>should not use endsas in viya 3.5 as this destroys the session and cannot fetch results (although both <a class="el" href="mv__getjoblog_8sas.html" title="Extract the log from a completed SAS Viya Job.">mv_getjoblog.sas</a> and the @sasjs/adapter will recognise this and fetch the log of the parent session instead) </li>
<li>STP environments must finish cleanly to avoid the log being sent to _webout. To assist with this, we also run stpsrvset('program error', 0) and set SYSCC=0. Where possible, we take a unique "soft abort" approach - we open a macro but don't close it! This works everywhere EXCEPT inside a %include inside a macro. For that, we recommend you use <a class="el" href="mp__include_8sas.html" title="Performs a wrapped %include.">mp_include.sas</a> to perform the include, and then call %mp_abort(mode=INCLUDE) from the source program (ie, OUTSIDE of the top-parent macro). The soft abort has also been found to be ineffective in 9.4m6 windows environments.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mac=</td><td>(<a class="el" href="mp__abort_8sas.html" title="abort gracefully according to context">mp_abort.sas</a>) To contain the name of the calling macro. Do not use &amp;sysmacroname as this will always resolve to MP_ABORT. </td></tr>
    <tr><td class="paramname">msg=</td><td>message to be returned </td></tr>
    <tr><td class="paramname">iftrue=</td><td>(1=1) Supply a condition for which the macro should be executed </td></tr>
    <tr><td class="paramname">errds=</td><td>(work.mp_abort_errds) There is no clean way to end a process within a include called within a macro. Furthermore, there is no way to test if a macro is called within a include. To handle this particular scenario, the include should be switched for the <a class="el" href="mp__include_8sas.html" title="Performs a wrapped %include.">mp_include.sas</a> macro. This provides an indicator that we are running a macro within a %include (<code>_SYSINCLUDEFILEDEVICE</code>) and allows us to provide a dataset with the abort values (msg, mac). We can then run an abort cancel FILE to stop the include running, and pass the dataset back to the calling program to run a regular %mp_abort(). The dataset will contain the following fields: <ul>
<li>iftrue (1=1) </li>
<li>msg (the message) </li>
<li>mac (the mac param)</li>
</ul>
</td></tr>
    <tr><td class="paramname">mode=</td><td>(REGULAR) If mode=INCLUDE then the &amp;errds dataset is checked for an abort status. Valid values: <ul>
<li>REGULAR (default) </li>
<li>INCLUDE</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section version"><dt>Version</dt><dd>9.4 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Allan Bowe</dd></dl>
<h4>Related Macros </h4>
<ul>
<li><a class="el" href="mp__include_8sas.html" title="Performs a wrapped %include.">mp_include.sas</a> </li>
</ul>

<p class="definition">Definition in file <a class="el" href="mp__abort_8sas_source.html">mp_abort.sas</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
  <!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e914ee4d4a44400f1fdb170cb4ead18a.html">base</a></li><li class="navelem"><a class="el" href="mp__abort_8sas.html">mp_abort.sas</a></li>
    <li class="footer">
      Generated by
      <a href="https://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.svg" alt="doxygen"
      /></a>
      1.9.3
    </li>
    <li>
      <i> For more information visit the </i>
      <a href="https://github.com/sasjs/core">Macro Core library</a>.
    </li>
  </ul>
</div>
